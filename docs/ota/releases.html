<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‰ˆæœ¬å†å² - PySpOS | GoutouStdio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Fira+Code:wght@400;500;700&family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ</text></svg>">
</head>
<body class="product-page pyspos-page">
    <header>
        <div class="container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-cube"></i>
                </div>
                <div>
                    <h1>GoutouStdio</h1>
                    <span class="subtitle">ç§‘æŠ€åˆ›æ–°å·¥ä½œå®¤</span>
                </div>
            </div>
            <div class="nav-toggle" id="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>
            <nav class="nav-menu" id="nav-menu">
                <ul>
                    <li><a href="../index.html">é¦–é¡µ</a></li>
                    <li><a href="../pyspos.html">PySpOS</a></li>
                    <li><a href="../spaceos6.html">SpaceOS 6</a></li>
                    <li><a href="../spaceos7.html">SpaceOS 7</a></li>
                    <li><a href="../index.html#history">å‘å±•å†ç¨‹</a></li>
                    <li><a href="../index.html#about">å…³äºæˆ‘ä»¬</a></li>
                    <li><a href="../index.html#contact">è”ç³»æˆ‘ä»¬</a></li>
                    <li><a href="https://github.com/GoutouStdio-cn" target="_blank" class="nav-link"><i class="fab fa-github"></i> GitHub</a></li>
                </ul>
                <div class="nav-indicator" id="nav-indicator"></div>
            </nav>
        </div>
    </header>

    <main>
        <section class="product-hero" id="releases-hero" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.15) 0%, rgba(99, 102, 241, 0.05) 100%);">
            <div class="container">
                <div class="product-hero-content">
                    <div class="hero-badge" style="border-color: rgba(139, 92, 246, 0.4);">
                        <i class="fas fa-history" style="color: #8b5cf6;"></i>
                        <span>PySpOS ç‰ˆæœ¬å†å²</span>
                    </div>
                    <h1 class="product-hero-title" style="color: #8b5cf6;">ç‰ˆæœ¬å†å²</h1>
                    <p class="product-hero-subtitle">æŸ¥çœ‹ PySpOS çš„æ‰€æœ‰å†å²ç‰ˆæœ¬å’Œæ›´æ–°æ—¥å¿—</p>
                    <div class="hero-buttons">
                        <a href="index.html" class="btn btn-primary btn-lg" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                            <i class="fas fa-download"></i>
                            ä¸‹è½½æ›´æ–°
                        </a>
                        <a href="../pyspos.html" class="btn btn-secondary btn-lg">
                            <i class="fas fa-info-circle"></i>
                            äº†è§£ PySpOS
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section class="version-info">
            <div class="container">
                <h2 class="section-title">å†å²ç‰ˆæœ¬</h2>
                <div id="version-history"></div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <div class="logo-icon">
                        <i class="fas fa-cube"></i>
                    </div>
                    <div>
                        <h3>GoutouStdio</h3>
                        <p>ç§‘æŠ€åˆ›æ–°å·¥ä½œå®¤</p>
                    </div>
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h4>äº§å“</h4>
                        <ul>
                            <li><a href="../pyspos.html">PySpOS</a></li>
                            <li><a href="../spaceos6.html">SpaceOS 6</a></li>
                            <li><a href="../spaceos7.html">SpaceOS 7</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>èµ„æº</h4>
                        <ul>
                            <li><a href="../index.html">é¦–é¡µ</a></li>
                            <li><a href="../index.html#history">å‘å±•å†ç¨‹</a></li>
                            <li><a href="../index.html#about">å…³äºæˆ‘ä»¬</a></li>
                            <li><a href="../index.html#contact">è”ç³»æˆ‘ä»¬</a></li>
                            <li><a href="https://github.com/GoutouStdio-cn" target="_blank">GitHub</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>æ³•å¾‹</h4>
                        <ul>
                            <li><a href="#">éšç§æ”¿ç­–</a></li>
                            <li><a href="#">ä½¿ç”¨æ¡æ¬¾</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2022~2026 GoutouStdio. Open all rights.</p>
            </div>
        </div>
    </footer>

    <script>
        const fallbackVersionData = { 
            "changelog": [
                {
                    "version": "3.0.1-pre",
                    "date": "2026-02-04",
                    "type": "beta",
                    "changes": [
                        "æ”¯æŒåœ¨çº¿ OTA æ›´æ–°ã€‚æˆ‘èŠ±äº†å¾ˆä¹…å®ç°äº†è¿™ä¸ªåŠŸèƒ½",
                        "é‡æ„ä¼˜åŒ–äº†éƒ¨åˆ†ä»£ç ",
                        "æ·»åŠ ä¸€ä¸ªçŒå¥‡ç½‘é¡µ"
                    ]
                },
                {
                    "version": "3.0.0",
                    "date": "2026-01-24",
                    "type": "beta",
                    "changes": [
                        "å®Œå–„äº† zzlsb çŒœæ•°å­—æ¸¸æˆ",
                        "ä¿®å¤è‹¥å¹² bug",
                        "å®ç°äº†ç®€æ˜“çš„ recovery å’Œæ—¥å¿—å¤„ç†"
                    ]
                }
            ]
        };

        async function loadVersionData() {
            try {
                console.log('å¼€å§‹åŠ è½½ç‰ˆæœ¬æ•°æ®...');
                const response = await fetch('version.json');
                console.log('å“åº”çŠ¶æ€:', response.status, response.statusText);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const versionData = await response.json();
                console.log('ç‰ˆæœ¬æ•°æ®åŠ è½½æˆåŠŸ:', versionData);
                renderVersionHistory(versionData);
            } catch (error) {
                console.error('åŠ è½½ç‰ˆæœ¬æ•°æ®å¤±è´¥:', error);
                console.error('é”™è¯¯è¯¦æƒ…:', error.message);
                console.log('ä½¿ç”¨å¤‡ç”¨æ•°æ®...');
                renderVersionHistory(fallbackVersionData);
            }
        }

        function compareVersions(version1, version2) {
            const parseVersion = (version) => {
                const parts = version.split('-');
                const main = parts[0].split('.').map(Number);
                const prerelease = parts[1] || '';
                return { main, prerelease };
            };

            const v1 = parseVersion(version1);
            const v2 = parseVersion(version2);

            for (let i = 0; i < Math.max(v1.main.length, v2.main.length); i++) {
                const num1 = v1.main[i] || 0;
                const num2 = v2.main[i] || 0;
                if (num1 > num2) return 1;
                if (num1 < num2) return -1;
            }

            if (v1.prerelease && !v2.prerelease) return -1;
            if (!v1.prerelease && v2.prerelease) return 1;
            if (v1.prerelease && v2.prerelease) {
                return v1.prerelease.localeCompare(v2.prerelease);
            }

            return 0;
        }

        async function getFileSize(url) {
            try {
                const response = await fetch(url, { method: 'HEAD' });
                if (response.ok) {
                    const contentLength = response.headers.get('content-length');
                    if (contentLength) {
                        const size = parseInt(contentLength, 10);
                        if (size < 1024) {
                            return `${size} B`;
                        } else if (size < 1024 * 1024) {
                            return `${(size / 1024).toFixed(1)} KB`;
                        } else {
                            return `${(size / (1024 * 1024)).toFixed(1)} MB`;
                        }
                    }
                }
                return 'æœªçŸ¥';
            } catch (error) {
                console.error('è·å–æ–‡ä»¶å¤§å°å¤±è´¥:', error);
                return 'æœªçŸ¥';
            }
        }

        async function renderVersionHistory(versionData) {
            const container = document.getElementById('version-history');
            let html = '<div class="version-cards">';

            const versions = versionData.changelog.map(release => release.version);
            const latestVersion = versions.reduce((latest, current) => {
                return compareVersions(current, latest) > 0 ? current : latest;
            });

            versionData.changelog.forEach((release) => {
                const isNew = release.version === latestVersion;
                const badgeClass = release.type === 'release' ? 'badge-stable' : 'badge-beta';
                const badgeText = release.type === 'release' ? 'æ­£å¼ç‰ˆ' : 'æµ‹è¯•ç‰ˆ';
                const newBadge = isNew ? '<span class="badge badge-new">NEW</span>' : '';
                
                let downloadUrl;
                if (release.download_url) {
                    downloadUrl = release.download_url;
                } else {
                    const releaseTag = release.version === '3.0.1-pre' ? 'pre_version' : 'beta_version';
                    downloadUrl = isNew ? 'PySpOS.zip' : `https://github.com/GoutouStdio-cn/PySpOS/releases/download/${releaseTag}/PySpOS.zip`;
                }
                
                const sha256 = release.version === '3.0.0' ? 'æ­¤ç‰ˆæœ¬çš„ SHA256 æ ¡éªŒå’ŒæœªçŸ¥' : (release.sha256 || 'æ­¤ç‰ˆæœ¬çš„ SHA256 æ ¡éªŒå’ŒæœªçŸ¥');
                
                let fileSize = release.file_size || 'æœªçŸ¥';
                if (typeof release.file_size === 'number') {
                    const size = release.file_size;
                    if (size < 1024) {
                        fileSize = `${size} B`;
                    } else if (size < 1024 * 1024) {
                        fileSize = `${(size / 1024).toFixed(1)} KB`;
                    } else {
                        fileSize = `${(size / (1024 * 1024)).toFixed(1)} MB`;
                    }
                }

                html += `
                    <div class="version-card ${isNew ? 'latest' : ''}">
                        <h3>v${release.version} ${newBadge} <span class="badge ${badgeClass}">${badgeText}</span></h3>
                        <div class="meta-info">
                            <div class="date">${release.date}</div>
                            <div class="file-size">${fileSize}</div>
                        </div>
                        <div class="changes">
                            <h4>æ›´æ–°å†…å®¹</h4>
                            <ul>
                                ${release.changes.map(change => `<li>${change}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="sha256-info">
                            <h4>SHA256 æ ¡éªŒå’Œ</h4>
                            <code>${sha256}</code>
                        </div>
                        <div class="download-actions">
                            <a href="${downloadUrl}" class="btn btn-primary">
                                ä¸‹è½½æºä»£ç  <i class="fas fa-download"></i>
                            </a>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            container.innerHTML = html;
        }

        document.addEventListener('DOMContentLoaded', loadVersionData);

        const navToggle = document.getElementById('nav-toggle');
        const navMenu = document.getElementById('nav-menu');

        if (navToggle && navMenu) {
            navToggle.addEventListener('click', function() {
                navMenu.classList.toggle('active');
            });
        }

        document.addEventListener('click', function(e) {
            if (navMenu && navMenu.classList.contains('active')) {
                if (!navMenu.contains(e.target) && !navToggle.contains(e.target)) {
                    navMenu.classList.remove('active');
                }
            }
        });
    </script>
</body>
</html>
