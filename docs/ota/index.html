<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OTA æ›´æ–° - PySpOS | GoutouStdio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Fira+Code:wght@400;500;700&family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ</text></svg>">
</head>
<body class="product-page pyspos-page">
    <header>
        <div class="container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-cube"></i>
                </div>
                <div>
                    <h1>GoutouStdio</h1>
                    <span class="subtitle">ç§‘æŠ€åˆ›æ–°å·¥ä½œå®¤</span>
                </div>
            </div>
            <div class="nav-toggle" id="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>
            <nav class="nav-menu" id="nav-menu">
                <ul>
                    <li><a href="../index.html">é¦–é¡µ</a></li>
                    <li><a href="../pyspos.html">PySpOS</a></li>
                    <li><a href="../spaceos6.html">SpaceOS 6</a></li>
                    <li><a href="../spaceos7.html">SpaceOS 7</a></li>
                    <li><a href="../index.html#history">å‘å±•å†ç¨‹</a></li>
                    <li><a href="../index.html#about">å…³äºæˆ‘ä»¬</a></li>
                    <li><a href="../index.html#contact">è”ç³»æˆ‘ä»¬</a></li>
                    <li><a href="https://github.com/GoutouStdio-cn" target="_blank" class="nav-link"><i class="fab fa-github"></i> GitHub</a></li>
                </ul>
                <div class="nav-indicator" id="nav-indicator"></div>
            </nav>
        </div>
    </header>

    <main>
        <section class="product-hero" id="ota-hero" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(139, 92, 246, 0.05) 100%);">
            <div class="container">
                <div class="product-hero-content">
                    <div class="hero-badge" style="border-color: rgba(99, 102, 241, 0.4);">
                        <i class="fas fa-wifi" style="color: #6366f1;"></i>
                        <span>PySpOS OTA æ›´æ–°</span>
                    </div>
                    <h1 class="product-hero-title" style="color: #6366f1;">OTA ç³»ç»Ÿæ›´æ–°ä¸‹è½½</h1>
                    <p class="product-hero-subtitle">ä»äº‘ç«¯ä¸‹è½½æœ€æ–°çš„ PySpOS ç³»ç»Ÿæ›´æ–°ï¼Œæ”¯æŒ A/B æ§½ä½æ— ç¼å‡çº§</p>
                    <div class="hero-buttons">
                        <a href="#download" class="btn btn-primary btn-lg" style="background: linear-gradient(135deg, #6366f1, #4f46e5);">
                            <i class="fas fa-download"></i>
                            ä¸‹è½½æ›´æ–°
                        </a>
                        <a href="releases.html" class="btn btn-secondary btn-lg">
                            <i class="fas fa-list"></i>
                            ç‰ˆæœ¬å†å²
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section class="version-info" id="download">
            <div class="container">
                <h2 class="section-title">ç‰ˆæœ¬ä¿¡æ¯</h2>
                <div id="version-info-container">
                    <div class="version-cards">
                        <div class="version-card current">
                            <h3>å½“å‰ç‰ˆæœ¬ <span class="badge badge-beta">æµ‹è¯•ç‰ˆ</span></h3>
                            <div class="version">3.0.1-pre</div>
                            <div class="meta-info">
                                <div class="date">2026-02-04</div>
                                <div class="file-size">62.4 KB</div>
                            </div>
                        </div>
                        <div class="version-card latest">
                            <h3>æœ€æ–°ç‰ˆæœ¬ <span class="badge badge-new">NEW</span> <span class="badge badge-beta">æµ‹è¯•ç‰ˆ</span></h3>
                            <div class="version">3.0.1-pre</div>
                            <div class="meta-info">
                                <div class="date">2026-02-04</div>
                                <div class="file-size">62.4 KB</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="download-section">
            <div class="container">
                <h2 class="section-title">ä¸‹è½½æ›´æ–°åŒ…</h2>
                <div id="download-container">
                    <div class="download-buttons">
                        <a href="PySpOS.zip" class="btn btn-primary">
                            ä¸‹è½½ v3.0.1-pre æºä»£ç  <i class="fas fa-download"></i>
                        </a>
                        <a href="releases.html" class="btn btn-secondary">
                            æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬ <i class="fas fa-list"></i>
                        </a>
                    </div>
                    <p style="margin-top: 20px; color: #e5e5e5; font-size: 14px;">
                        æ–‡ä»¶å¤§å°ï¼š62.4 KB<br>
                        SHA256: <code>124ea876d602cb51d9212f9c9b73091d09690b29a17e55607b171605452a7b87</code>
                    </p>
                </div>
            </div>
        </section>

        <section class="changelog">
            <div class="container">
                <h2 class="section-title">æ›´æ–°æ—¥å¿—</h2>
                <div id="changelog-content"></div>
            </div>
        </section>


        <section class="compatibility">
            <div class="container">
                <h2 class="section-title">å…¼å®¹æ€§è¦æ±‚</h2>
                <ul class="compatibility-list">
                    <li>Python 3.7 æˆ–æ›´é«˜ç‰ˆæœ¬</li>
                    <li>Windows 7 åŠä»¥ä¸Š / Linux / macOS</li>
                    <li>è‡³å°‘ 50MB å¯ç”¨ç£ç›˜ç©ºé—´</li>
                    <li>request åº“ï¼ˆç”¨äºæŠ“å–äº‘ç«¯ ota å†…å®¹ï¼‰</li>
                </ul>
            </div>
        </section>

        <section class="rollback">
            <div class="container">
                <h2 class="section-title">å›æ»šæŒ‡å—</h2>
                <p style="margin-bottom: 20px; color: #e5e5e5;">å¦‚æœæ›´æ–°åé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥å›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼š</p>
                <ul class="rollback-steps">
                    <li data-step="1">åœ¨ PySpOS ä¸­è¾“å…¥ <code>recovery</code> å‘½ä»¤è¿›å…¥æ¢å¤æ¨¡å¼</li>
                    <li data-step="2">åœ¨æ¢å¤æ¨¡å¼ä¸­è¾“å…¥ <code>ota_rollback</code> å‘½ä»¤</li>
                    <li data-step="3">ç¡®è®¤å›æ»šæ“ä½œ</li>
                    <li data-step="4">é‡å¯ PySpOS ä»¥åº”ç”¨æ›´æ”¹</li>
                </ul>
                <p style="margin-top: 20px; color: #e5e5e5; font-size: 14px;">
                    æ³¨æ„ï¼šå›æ»šæ“ä½œä¼šåˆ‡æ¢åˆ°å¦ä¸€ä¸ªæ§½ä½ï¼Œè¯·ç¡®ä¿å¦ä¸€ä¸ªæ§½ä½åŒ…å«æœ‰æ•ˆçš„ç³»ç»Ÿç‰ˆæœ¬ã€‚ï¼ˆå¦‚æ²¡æœ‰æ–‡ä»¶ï¼Œç³»ç»Ÿå¯èƒ½ä¼šå˜ç –ã€‚ï¼‰
                </p>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <div class="logo-icon">
                        <i class="fas fa-cube"></i>
                    </div>
                    <div>
                        <h3>GoutouStdio</h3>
                        <p>ç§‘æŠ€åˆ›æ–°å·¥ä½œå®¤</p>
                    </div>
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h4>äº§å“</h4>
                        <ul>
                            <li><a href="../pyspos.html">PySpOS</a></li>
                            <li><a href="../spaceos6.html">SpaceOS 6</a></li>
                            <li><a href="../spaceos7.html">SpaceOS 7</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>èµ„æº</h4>
                        <ul>
                            <li><a href="../index.html">é¦–é¡µ</a></li>
                            <li><a href="../index.html#history">å‘å±•å†ç¨‹</a></li>
                            <li><a href="../index.html#about">å…³äºæˆ‘ä»¬</a></li>
                            <li><a href="../index.html#contact">è”ç³»æˆ‘ä»¬</a></li>
                            <li><a href="https://github.com/GoutouStdio-cn" target="_blank">GitHub</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>æ³•å¾‹</h4>
                        <ul>
                            <li><a href="#">éšç§æ”¿ç­–</a></li>
                            <li><a href="#">ä½¿ç”¨æ¡æ¬¾</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2022~2026 GoutouStdio. Open all rights.</p>
            </div>
        </div>
    </footer>

    <script>
        async function loadVersionData() {
            try {
                console.log('å¼€å§‹åŠ è½½ç‰ˆæœ¬æ•°æ®...');
                const response = await fetch('version.json');
                console.log('å“åº”çŠ¶æ€:', response.status, response.statusText);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const versionData = await response.json();
                console.log('ç‰ˆæœ¬æ•°æ®åŠ è½½æˆåŠŸ:', versionData);
                updatePageContent(versionData);
            } catch (error) {
                console.error('åŠ è½½ç‰ˆæœ¬æ•°æ®å¤±è´¥:', error);
                console.error('é”™è¯¯è¯¦æƒ…:', error.message);
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function updatePageContent(versionData) {
            const latestVersion = versionData.version;
            const releaseDate = versionData.release_date;
            const fileSize = formatFileSize(versionData.file_size);
            const sha256 = versionData.sha256;
            const releaseNotes = versionData.release_notes;
            const isBeta = versionData.develop_stage === 'beta';
            const badgeClass = isBeta ? 'badge-beta' : 'badge-stable';
            const badgeText = isBeta ? 'æµ‹è¯•ç‰ˆ' : 'æ­£å¼ç‰ˆ';

            // ç¡®å®šä¸‹è½½é“¾æ¥
            let downloadUrl;
            if (versionData.download_url) {
                // åˆ¤æ–­æ˜¯å¦æ˜¯é‡æ„å»ºç‰ˆæœ¬ï¼ˆæ–‡ä»¶åæ ¼å¼ä¸º PySpOS-ç‰ˆæœ¬ - æ—¥æœŸ.zipï¼‰
                const isRebuild = versionData.download_url.match(/PySpOS-[\d.]+-[\d]+\.zip/);
                
                if (isRebuild) {
                    // å¦‚æœæ˜¯é‡æ„å»ºç‰ˆæœ¬ï¼Œä½¿ç”¨æ–°çš„æ–‡ä»¶å
                    downloadUrl = versionData.download_url;
                } else if (versionData.download_url === 'PySpOS.zip') {
                    // å¦‚æœæ˜¯ PySpOS.zipï¼Œä»æœåŠ¡å™¨ä¸‹è½½
                    downloadUrl = 'PySpOS.zip';
                } else {
                    // å¦åˆ™ä½¿ç”¨ download_url
                    downloadUrl = versionData.download_url;
                }
            } else {
                // å¦‚æœæ²¡æœ‰ download_urlï¼Œä½¿ç”¨é»˜è®¤çš„ PySpOS.zip
                downloadUrl = 'PySpOS.zip';
            }

            // æ›´æ–°é¡µé¢å†…å®¹
            document.querySelector('.version-card.latest .version').textContent = latestVersion;
            document.querySelector('.version-card.latest .date').textContent = releaseDate;
            document.querySelector('.version-card.latest .file-size').textContent = fileSize;
            
            const downloadBtn = document.querySelector('.download-buttons .btn-primary');
            if (downloadBtn) {
                downloadBtn.href = downloadUrl;
                downloadBtn.innerHTML = `ä¸‹è½½ v${latestVersion} æºä»£ç  <i class="fas fa-download"></i>`;
            }
            
            const sha256Element = document.querySelector('#download-container p code');
            if (sha256Element) {
                sha256Element.textContent = sha256;
            }
            
            const changelogElement = document.getElementById('changelog-content');
            if (changelogElement && releaseNotes) {
                changelogElement.innerHTML = `<div class="changelog-content"><p>${releaseNotes.replace(/\n/g, '<br>')}</p></div>`;
            }
        }

        // é¡µé¢åŠ è½½å®ŒæˆååŠ è½½ç‰ˆæœ¬æ•°æ®
        document.addEventListener('DOMContentLoaded', loadVersionData);

        // Mobile Navigation Toggle
        const navToggle = document.getElementById('nav-toggle');
        const navMenu = document.getElementById('nav-menu');

        if (navToggle && navMenu) {
            navToggle.addEventListener('click', function() {
                navMenu.classList.toggle('active');
            });
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(e) {
            if (navMenu && navMenu.classList.contains('active')) {
                if (!navMenu.contains(e.target) && !navToggle.contains(e.target)) {
                    navMenu.classList.remove('active');
                }
            }
        });
    </script>
</body>
</html>
